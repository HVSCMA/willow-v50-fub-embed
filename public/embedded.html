<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WILLOW V50 Intelligence</title>
    <link rel="stylesheet" href="embedded.css">
</head>

<body>
    <div id="willow-app">
        <div id="app-header">
            <h1 class="logo">WILLOW</h1>
            <div id="momentum-chip" class="momentum-chip">
                <span class="icon">üî•</span>
                <span id="momentum-count">0</span>
            </div>
        </div>
        <div id="loading-state" class="loading">
            <div class="spinner"></div>
            <p>Loading WILLOW Intelligence...</p>
        </div>

        <div id="error-state" class="error hidden">
            <p class="error-message"></p>
            <button onclick="location.reload()">Retry</button>
        </div>

        <div id="main-content" class="hidden">
            <!-- Agent Moment Zero Panel (Primary) -->
            <div id="agent-moment-zero-panel" class="amz-panel">
                <div class="amz-header">
                    <h2>Agent Moment Zero</h2>
                    <span id="amz-status-badge" class="badge">--</span>
                </div>

                <div class="amz-section params-grid">
                    <div class="amz-metric">
                        <label>Est. Value</label>
                        <div class="value-large" id="amz-est-value">--</div>
                    </div>
                    <div class="amz-metric">
                        <label>Range</label>
                        <div class="value-small" id="amz-range">--</div>
                    </div>
                </div>

                <div class="amz-section audio-box">
                    <div class="label-row">
                        <span class="icon">üéß</span>
                        <label>Audio Lead Review</label>
                    </div>
                    <div class="audio-player">
                        <button id="play-briefing-btn" class="play-btn">‚ñ∂</button>
                        <div class="audio-visualizer">
                            <div class="bar"></div>
                            <div class="bar"></div>
                            <div class="bar"></div>
                            <div class="bar"></div>
                        </div>
                    </div>
                    <div id="audio-transcript" class="transcript hidden"></div>
                </div>

                <div class="amz-section">
                    <div class="label-row">
                        <span class="icon">‚ö°</span>
                        <label>Why Now? (Internal)</label>
                    </div>
                    <div id="amz-why-now" class="highlight-text">--</div>
                </div>

                <div class="amz-section recommendation-box">
                    <div class="label-row">
                        <span class="icon">üéØ</span>
                        <label>Recommended Action</label>
                    </div>
                    <div id="amz-action" class="action-text">--</div>
                </div>

                <div class="amz-section script-box">
                    <div class="label-row">
                        <span class="icon">üí¨</span>
                        <label>Broker Script (Client Safe)</label>
                        <button class="copy-btn" id="copy-script-btn" title="Copy to clipboard">üìã</button>
                    </div>
                    <div id="amz-script" class="script-text">--</div>
                </div>

                <div class="amz-actions">
                    <button id="amz-log-note-btn" class="btn btn-primary full-width">
                        üìù Log Note
                    </button>
                    <div class="btn-group">
                        <button id="amz-cma-btn" class="btn btn-secondary">
                            üìä CMA Draft
                        </button>
                        <button id="amz-update-val-btn" class="btn btn-secondary">
                            üí∞ Update Val
                        </button>
                    </div>
                </div>
            </div>

            <!-- Behavioral Score Display (Secondary) -->
            <div class="score-card secondary-card">
                <div class="score-header">
                    <h2>Behavioral Score</h2>
                    <span id="priority-badge" class="badge"></span>
                </div>
                <div class="score-display">
                    <div class="score-value" id="behavior-score">-</div>
                    <div class="score-label">out of 100</div>
                </div>
                <!-- <div class="score-breakdown" id="score-breakdown"></div> -->
            </div>

            <!-- Active Triggers -->
            <div class="triggers-section" id="triggers-section">
                <h3>Active Triggers</h3>
                <div id="triggers-list" class="triggers-list"></div>
            </div>

            <!-- Property Intelligence -->
            <div class="property-section">
                <h3>Property Intelligence</h3>
                <div id="property-info" class="property-info"></div>
            </div>

            <!-- CMA Parameters -->
            <div class="cma-section">
                <h3>CMA Parameters</h3>

                <div class="param-group">
                    <label for="radius-slider">Radius: <span id="radius-value">1</span> mi</label>
                    <input type="range" id="radius-slider" min="0.5" max="5" step="0.5" value="1">
                </div>

                <div class="param-group">
                    <label for="days-slider">Days Back: <span id="days-value">365</span></label>
                    <input type="range" id="days-slider" min="180" max="730" step="30" value="365">
                </div>

                <div class="param-group">
                    <label for="comps-slider">Comparables: <span id="comps-value">20</span></label>
                    <input type="range" id="comps-slider" min="5" max="30" step="1" value="20">
                </div>

                <div class="param-group">
                    <label for="variance-slider">Price Variance: <span id="variance-value">10</span>%</label>
                    <input type="range" id="variance-slider" min="5" max="25" step="5" value="10">
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="actions">
                <div class="gate-checkbox">
                    <input type="checkbox" id="cma-pricing-gate">
                    <label for="cma-pricing-gate">I confirm pricing is accurate</label>
                </div>
                <button id="generate-cma-btn" class="btn btn-primary" disabled>
                    <span class="btn-icon">üìä</span>
                    Generate CMA
                </button>
                <button id="open-full-btn" class="btn btn-secondary">
                    <span class="btn-icon">üöÄ</span>
                    Open Full Window
                </button>
            </div>
            <!-- AI Chat Interface -->
            <div id="ai-chat-interface" class="chat-interface collapsed">
                <div class="chat-header" id="chat-toggle">
                    <span class="icon">ü§ñ</span>
                    <span>Assistant</span>
                    <span class="toggle-icon">‚ñ≤</span>
                </div>
                <div class="chat-body hidden" id="chat-body">
                    <div class="chat-messages" id="chat-messages">
                        <div class="message ai">Ready. Context loaded.</div>
                    </div>
                    <div class="chat-input-area">
                        <input type="text" id="chat-input" placeholder="Ask helper...">
                        <button id="chat-send-btn">‚û§</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="embedded-app.js?v=20251116-2200"></script>
</body>

</html>